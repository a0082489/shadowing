<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShadowSpeak Stable - 安定版シャドウイング練習アプリ</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .speed-button {
            background-color: #374151 !important;
            color: white !important;
            border: 2px solid #6B7280 !important;
            padding: 8px 16px !important;
            margin: 4px !important;
            border-radius: 6px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
        }
        .speed-button:hover {
            background-color: #4F46E5 !important;
            border-color: #4F46E5 !important;
            transform: translateY(-1px) !important;
        }
        .speed-button.active {
            background-color: #10B981 !important;
            border-color: #10B981 !important;
        }
        .custom-input {
            background-color: #F3F4F6 !important;
            color: #111827 !important;
            border: 2px solid #D1D5DB !important;
            padding: 12px 16px !important;
            border-radius: 8px !important;
            font-size: 16px !important;
            width: 100% !important;
        }
        .custom-input:focus {
            outline: none !important;
            border-color: #4F46E5 !important;
            background-color: white !important;
        }
        .custom-input::placeholder {
            color: #6B7280 !important;
            font-style: italic !important;
        }
        .load-button {
            background-color: #10B981 !important;
            color: white !important;
            border: none !important;
            padding: 12px 24px !important;
            border-radius: 8px !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            font-size: 16px !important;
        }
        .load-button:hover {
            background-color: #059669 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3) !important;
        }
        .control-button {
            background-color: #4F46E5 !important;
            color: white !important;
            border: none !important;
            padding: 10px 20px !important;
            margin: 5px !important;
            border-radius: 6px !important;
            cursor: pointer !important;
            font-weight: 500 !important;
            transition: all 0.3s ease !important;
        }
        .control-button:hover {
            background-color: #3730A3 !important;
            transform: translateY(-1px) !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                <i class="fas fa-video text-blue-600"></i> ShadowSpeak Stable
            </h1>
            <p class="text-xl text-gray-600">2画面同期シャドウイング練習アプリ</p>
        </header>

        <!-- タブメニュー -->
        <div class="bg-white rounded-lg shadow-lg mb-8">
            <div class="flex border-b">
                <button id="tedTab" class="flex-1 py-4 px-6 text-center font-semibold text-blue-600 border-b-2 border-blue-600 bg-blue-50" onclick="showTab('ted')">
                    <i class="fas fa-graduation-cap mr-2"></i>TED Talks
                </button>
                <button id="dailyTab" class="flex-1 py-4 px-6 text-center font-semibold text-gray-600 hover:text-blue-600 hover:bg-gray-50" onclick="showTab('daily')">
                    <i class="fas fa-comments mr-2"></i>日常会話
                </button>
                <button id="businessTab" class="flex-1 py-4 px-6 text-center font-semibold text-gray-600 hover:text-blue-600 hover:bg-gray-50" onclick="showTab('business')">
                    <i class="fas fa-briefcase mr-2"></i>ビジネス
                </button>
                <button id="customTab" class="flex-1 py-4 px-6 text-center font-semibold text-gray-600 hover:text-blue-600 hover:bg-gray-50" onclick="showTab('custom')">
                    <i class="fas fa-link mr-2"></i>カスタム動画
                </button>
            </div>

            <!-- TED Talks -->
            <div id="tedContent" class="p-6">
                <div class="grid md:grid-cols-2 gap-4">
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('Y6bbMQXQ180')">
                        <div class="font-semibold text-gray-800">成功の秘訣 (3:47)</div>
                        <div class="text-sm text-gray-600">Richard St. John - 8つの言葉で語る成功の秘訣</div>
                        <div class="text-xs text-green-600 mt-1">初級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('UNP03fDSj1U')">
                        <div class="font-semibold text-gray-800">30日チャレンジ (3:28)</div>
                        <div class="text-sm text-gray-600">Matt Cutts - 30日間新しいことに挑戦する</div>
                        <div class="text-xs text-green-600 mt-1">初級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('H14bBuluwB8')">
                        <div class="font-semibold text-gray-800">やり抜く力 (6:13)</div>
                        <div class="text-sm text-gray-600">Angela Lee Duckworth - 情熱と忍耐の力</div>
                        <div class="text-xs text-yellow-600 mt-1">中級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('o_XVt5rdpFY')">
                        <div class="font-semibold text-gray-800">言語学習の秘訣 (10:46)</div>
                        <div class="text-sm text-gray-600">Lýdia Machová - 新しい言語を学ぶ秘訣</div>
                        <div class="text-xs text-red-600 mt-1">上級レベル</div>
                    </button>
                </div>
            </div>

            <!-- 日常会話 -->
            <div id="dailyContent" class="p-6 hidden">
                <div class="grid md:grid-cols-2 gap-4">
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('ry9SYnV3svc')">
                        <div class="font-semibold text-gray-800">スモールトーク (2:14)</div>
                        <div class="text-sm text-gray-600">職場での日常会話</div>
                        <div class="text-xs text-green-600 mt-1">初級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('5ulpI_BP8Sg')">
                        <div class="font-semibold text-gray-800">朝の会話 (6:05)</div>
                        <div class="text-sm text-gray-600">Lisa、起きて！- 朝の日常会話</div>
                        <div class="text-xs text-yellow-600 mt-1">中級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('bq6GBbh3uhU')">
                        <div class="font-semibold text-gray-800">毎日することは？ (4:57)</div>
                        <div class="text-sm text-gray-600">BBC Learning English - 日常の動作</div>
                        <div class="text-xs text-yellow-600 mt-1">中級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('6E7i_7Mr_5c')">
                        <div class="font-semibold text-gray-800">リピート練習 (6:10)</div>
                        <div class="text-sm text-gray-600">楽しい物語でスピーキング練習</div>
                        <div class="text-xs text-yellow-600 mt-1">中級レベル</div>
                    </button>
                </div>
            </div>

            <!-- ビジネス英語 -->
            <div id="businessContent" class="p-6 hidden">
                <div class="grid md:grid-cols-2 gap-4">
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('kO-xNOOoxsM')">
                        <div class="font-semibold text-gray-800">ビジネス交渉 (2:22)</div>
                        <div class="text-sm text-gray-600">実践的な交渉フレーズ</div>
                        <div class="text-xs text-green-600 mt-1">初級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('GhvjZ_3s3PY')">
                        <div class="font-semibold text-gray-800">職場スモールトーク (2:21)</div>
                        <div class="text-sm text-gray-600">オフィスでの日常会話</div>
                        <div class="text-xs text-green-600 mt-1">初級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('fm6PtyM4qMw')">
                        <div class="font-semibold text-gray-800">職場での30の対話 (29:23)</div>
                        <div class="text-sm text-gray-600">ビジネス英語の基本対話集</div>
                        <div class="text-xs text-red-600 mt-1">上級レベル</div>
                    </button>
                    <button class="p-4 border border-gray-300 rounded-lg hover:bg-blue-50 text-left transition-colors" onclick="loadVideo('xu7hp9O54bk')">
                        <div class="font-semibold text-gray-800">35のビジネス場面 (38:47)</div>
                        <div class="text-sm text-gray-600">一般的なビジネス英語会話</div>
                        <div class="text-xs text-red-600 mt-1">上級レベル</div>
                    </button>
                </div>
            </div>

            <!-- カスタム動画 -->
            <div id="customContent" class="p-6 hidden">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-link mr-2"></i>YouTube動画のURLを入力してください
                        </label>
                        <input 
                            type="text" 
                            id="customVideoUrl" 
                            class="custom-input"
                            placeholder="https://www.youtube.com/watch?v=VIDEO_ID または https://youtu.be/VIDEO_ID"
                        >
                    </div>
                    <button 
                        onclick="loadCustomVideo()" 
                        class="load-button"
                    >
                        <i class="fas fa-play mr-2"></i>動画を読み込む
                    </button>
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h4 class="font-semibold text-blue-800 mb-2"><i class="fas fa-info-circle mr-2"></i>使用のコツ</h4>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>• 英語字幕付きの動画を選択してください</li>
                            <li>• TED Talks、BBC Learning English、教育系チャンネルがおすすめ</li>
                            <li>• 3-15分程度の動画が練習に最適です</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- 動画プレイヤー -->
        <div id="videoSection" class="bg-white rounded-lg shadow-lg p-6 hidden">
            <div class="mb-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">
                    <i class="fas fa-play-circle mr-2 text-blue-600"></i>シャドウイング練習
                </h3>
                
                <!-- コントロールパネル -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="flex flex-wrap items-center gap-2">
                            <span class="text-sm font-medium text-gray-700">再生速度:</span>
                            <button class="speed-button" onclick="setSpeed(0.25)">0.25x</button>
                            <button class="speed-button" onclick="setSpeed(0.5)">0.5x</button>
                            <button class="speed-button" onclick="setSpeed(0.75)">0.75x</button>
                            <button class="speed-button active" onclick="setSpeed(1)">1x</button>
                            <button class="speed-button" onclick="setSpeed(1.25)">1.25x</button>
                            <button class="speed-button" onclick="setSpeed(1.5)">1.5x</button>
                        </div>
                        <div class="flex gap-2">
                            <button class="control-button" onclick="playVideos()">
                                <i class="fas fa-play mr-1"></i>再生
                            </button>
                            <button class="control-button" onclick="pauseVideos()">
                                <i class="fas fa-pause mr-1"></i>一時停止
                            </button>
                            <button class="control-button" onclick="seekVideos(-10)">
                                <i class="fas fa-backward mr-1"></i>-10秒
                            </button>
                            <button class="control-button" onclick="seekVideos(10)">
                                <i class="fas fa-forward mr-1"></i>+10秒
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 2画面表示 -->
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- 左画面: 英語字幕 (音声ON) -->
                    <div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3">
                            <h4 class="font-semibold text-blue-800 flex items-center">
                                <i class="fas fa-volume-up mr-2"></i>英語字幕 (音声ON)
                            </h4>
                            <p class="text-sm text-blue-600">シャドウイング用音声</p>
                        </div>
                        <div class="video-container">
                            <iframe id="englishVideo" 
                                    src="" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                            </iframe>
                        </div>
                    </div>

                    <!-- 右画面: 日本語字幕 (音声OFF) -->
                    <div>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-3">
                            <h4 class="font-semibold text-green-800 flex items-center">
                                <i class="fas fa-volume-mute mr-2"></i>日本語字幕 (音声OFF)
                            </h4>
                            <p class="text-sm text-green-600">内容理解用字幕</p>
                        </div>
                        <div class="video-container">
                            <iframe id="japaneseVideo" 
                                    src="" 
                                    frameborder="0" 
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                    allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>

                <!-- 学習ガイド -->
                <div class="mt-6 bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4">
                    <h4 class="font-semibold text-purple-800 mb-2">
                        <i class="fas fa-lightbulb mr-2"></i>シャドウイング練習のコツ
                    </h4>
                    <div class="grid md:grid-cols-3 gap-4 text-sm text-purple-700">
                        <div>
                            <div class="font-medium">1. 音声に集中</div>
                            <div>左画面の英語音声をよく聞く</div>
                        </div>
                        <div>
                            <div class="font-medium">2. 同時発話</div>
                            <div>音声と同時に英語を話す</div>
                        </div>
                        <div>
                            <div class="font-medium">3. 意味確認</div>
                            <div>右画面で日本語の意味を確認</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- フッター -->
        <footer class="text-center text-gray-600 mt-8">
            <p>© 2024 ShadowSpeak. 英語シャドウイング練習アプリ</p>
        </footer>
    </div>

    <script>
        let currentSpeed = 1;
        let englishPlayer = null;
        let japanesePlayer = null;

        // YouTube Player API
        function onYouTubeIframeAPIReady() {
            console.log('YouTube API Ready');
        }

        // タブ切り替え
        function showTab(tabName) {
            // すべてのタブコンテンツを隠す
            document.getElementById('tedContent').classList.add('hidden');
            document.getElementById('dailyContent').classList.add('hidden');
            document.getElementById('businessContent').classList.add('hidden');
            document.getElementById('customContent').classList.add('hidden');

            // すべてのタブボタンを非アクティブにする
            const tabs = ['tedTab', 'dailyTab', 'businessTab', 'customTab'];
            tabs.forEach(tab => {
                const element = document.getElementById(tab);
                element.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600', 'bg-blue-50');
                element.classList.add('text-gray-600');
            });

            // アクティブなタブを表示
            document.getElementById(tabName + 'Content').classList.remove('hidden');
            const activeTab = document.getElementById(tabName + 'Tab');
            activeTab.classList.remove('text-gray-600');
            activeTab.classList.add('text-blue-600', 'border-b-2', 'border-blue-600', 'bg-blue-50');
        }

        // 動画読み込み
        function loadVideo(videoId) {
            const englishVideoSrc = `https://www.youtube.com/embed/${videoId}?enablejsapi=1&cc_load_policy=1&hl=en&cc_lang_pref=en`;
            const japaneseVideoSrc = `https://www.youtube.com/embed/${videoId}?enablejsapi=1&cc_load_policy=1&hl=ja&cc_lang_pref=ja&mute=1`;

            document.getElementById('englishVideo').src = englishVideoSrc;
            document.getElementById('japaneseVideo').src = japaneseVideoSrc;
            
            document.getElementById('videoSection').classList.remove('hidden');
            
            // スクロールして動画セクションへ
            document.getElementById('videoSection').scrollIntoView({ behavior: 'smooth' });
        }

        // カスタム動画読み込み
        function loadCustomVideo() {
            const url = document.getElementById('customVideoUrl').value.trim();
            if (!url) {
                alert('YouTube URLを入力してください。');
                return;
            }

            const videoId = extractVideoId(url);
            if (!videoId) {
                alert('有効なYouTube URLを入力してください。');
                return;
            }

            loadVideo(videoId);
        }

        // YouTube URL からビデオIDを抽出
        function extractVideoId(url) {
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // 速度設定
        function setSpeed(speed) {
            currentSpeed = speed;
            
            // すべての速度ボタンから active クラスを削除
            document.querySelectorAll('.speed-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // クリックされたボタンに active クラスを追加
            event.target.classList.add('active');
            
            // 両方の動画の速度を設定
            postMessageToVideos({ command: 'setPlaybackRate', rate: speed });
        }

        // 動画再生
        function playVideos() {
            postMessageToVideos({ command: 'playVideo' });
        }

        // 動画一時停止
        function pauseVideos() {
            postMessageToVideos({ command: 'pauseVideo' });
        }

        // 動画シーク
        function seekVideos(seconds) {
            postMessageToVideos({ command: 'seekBy', seconds: seconds });
        }

        // 両方の動画にメッセージを送信
        function postMessageToVideos(message) {
            const englishVideo = document.getElementById('englishVideo');
            const japaneseVideo = document.getElementById('japaneseVideo');
            
            if (englishVideo && englishVideo.contentWindow) {
                englishVideo.contentWindow.postMessage('{"event":"command","func":"' + message.command + '","args":[' + (message.rate || message.seconds || '') + ']}', '*');
            }
            if (japaneseVideo && japaneseVideo.contentWindow) {
                japaneseVideo.contentWindow.postMessage('{"event":"command","func":"' + message.command + '","args":[' + (message.rate || message.seconds || '') + ']}', '*');
            }
        }

        // YouTube Player API の読み込み
        const tag = document.createElement('script');
        tag.src = 'https://www.youtube.com/iframe_api';
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // エンターキーでカスタム動画読み込み
        document.getElementById('customVideoUrl').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                loadCustomVideo();
            }
        });
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDnNyLq42%2FiFFL8FluaqUZY50mICFc6XBOBwZMDPf%2F0bFyYzp5UmpIxHNsnuN6L8TdnkWr3cDNIAYuu2InqdGAIzqptVV9mRoi4RT2D3mEKNwQv9FiPHGXBbC9IOCVBqW34QDqqSBvUqsJ3K6lovUwuenbNz72FiPnPq4C3bUPKjSwPuxz96VfDExMiBq4RVpLw3wmty%2BznF3EmDj6sHWuxObpTV6QnNJgOUEmJPOZi3gZw5hu2QYyHXWLFN0gifGW2p0f%2F0hg3BmtocytejANi61izU1VhAW4eJqig6b1ar0wjO2YmpejiZr6KNS4kZh0hDzEeddrvMKz3xwAzgGR0w8oZK8M8oC0wR8exAp3tCzapQqBRtapRzQbWogV9GOykVSyqFga2B9%2FkDOV6gTMQZNDNjA5NDoHA75idoZNY%2BBdoa2k%2B4Bh1rZahlM0wl%2FAtv3UCpSI4bIl02u4dUGLiPHLRSqTe2u46lLAhad5URKP8lmip5t7rwnEAjGFx5noA%3D%3D";
        window.__genspark_locale = "ja-JP";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDnNyLq42/iFFL8FluaqUZY50mICFc6XBOBwZMDPf/0bFyYzp5UmpIxHNsnuN6L8TdnkWr3cDNIAYuu2InqdGAIzqptVV9mRoi4RT2D3mEKNwQv9FiPHGXBbC9IOCVBqW34QDqqSBvUqsJ3K6lovUwuenbNz72FiPnPq4C3bUPKjSwPuxz96VfDExMiBq4RVpLw3wmty+znF3EmDj6sHWuxObpTV6QnNJgOUEmJPOZi3gZw5hu2QYyHXWLFN0gifGW2p0f/0hg3BmtocytejANi61izU1VhAW4eJqig6b1ar0wjO2YmpejiZr6KNS4kZh0hDzEeddrvMKz3xwAzgGR0w8oZK8M8oC0wR8exAp3tCzapQqBRtapRzQbWogV9GOykVSyqFga2B9/kDOV6gTMQZNDNjA5NDoHA75idoZNY+Bdoa2k+4Bh1rZahlM0wl/Atv3UCpSI4bIl02u4dUGLiPHLRSqTe2u46lLAhad5URKP8lmip5t7rwnEAjGFx5noA==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    